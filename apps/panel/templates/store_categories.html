{% extends "base.html" %}

{% block title %}Store Categories{% endblock %}

{% block content %}
<section>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
        <h2>Store Categories</h2>
        <button onclick="document.getElementById('add-category-modal').showModal()">Add Category</button>
    </div>

    <div class="grid">
        {% for category in categories %}
        <article id="category-{{ category.id }}">
            <header>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <hgroup>
                        <h3>{{ category.name }}</h3>
                        <p>Sort Order: {{ category.sort_order }}</p>
                    </hgroup>
                    <span class="badge {% if category.is_active %}success{% else %}secondary{% endif %}">
                        {% if category.is_active %}Active{% else %}Inactive{% endif %}
                    </span>
                </div>
            </header>

            <p>
                {% if let Some(desc) = category.description %}{{ desc }}{% else %}No description{% endif %}
            </p>

            <footer>
                <button class="secondary outline" hx-delete="{{ admin_path }}/store/categories/{{ category.id }}"
                    hx-confirm="Are you sure you want to delete this category?" hx-target="#category-{{ category.id }}"
                    hx-swap="outerHTML">
                    Delete
                </button>
            </footer>
        </article>
        {% endfor %}
    </div>
</section>

<!-- Add Category Modal -->
<dialog id="add-category-modal">
    <article>
        <header>
            <a href="#close" aria-label="Close" class="close"
                onclick="document.getElementById('add-category-modal').close()"></a>
            Create New Category
        </header>
        <form hx-post="{{ admin_path }}/store/categories" hx-target="body" hx-swap="none">
            <label for="name">Category Name</label>
            <input type="text" id="name" name="name" placeholder="VPN Keys" required>

            <label for="description">Description</label>
            <textarea id="description" name="description" placeholder="Access keys for VLESS..."></textarea>

            <label for="sort_order">Sort Order
                <input type="number" id="sort_order" name="sort_order" value="0" required>
            </label>

            <footer>
                <button type="submit">Create Category</button>
            </footer>
        </form>
    </article>
</dialog>
{% endblock %}